/*@license For license information please refer to shared-ui-flights-fare-calendar.licenses.txt*/
(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[2769],{96870:function(e,t,n){n.d(t,{Yk:function(){return R},x3:function(){return $}});var a=n(56195),r=n(60094),o=n.n(r),i=n(58268),l=n(29462),c=n(97778),s=n(86405),u=n(51213),d=n(2533),C=n(43888),g=n(70882),D=n(30707),p=n.n(D),h=n(26690),f=n(64341),m=n(63085),y=Object.defineProperty,F=Object.defineProperties,B=Object.getOwnPropertyDescriptors,_=Object.getOwnPropertySymbols,S=Object.prototype.hasOwnProperty,T=Object.prototype.propertyIsEnumerable,E=(e,t,n)=>t in e?y(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,O=(e,t)=>{for(var n in t||(t={}))S.call(t,n)&&E(e,n,t[n]);if(_)for(var n of _(t))T.call(t,n)&&E(e,n,t[n]);return e},k=(e,t)=>F(e,B(t));function x(e){const t=Date.parse(e);if(Number.isNaN(t)||!function(e){return/^(\d{4})-(\d{2})-(\d{2})$/.test(e)||/^\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\dZ$/.test(e)}(e))throw Error(`Failed to convert ${e} to a valid date.`);const n=new Date(e);return a=n,new Date(a.getUTCFullYear(),a.getUTCMonth(),a.getUTCDate(),a.getUTCHours(),a.getUTCMinutes(),a.getUTCSeconds());var a}function b(){const e=new Date;return new Date(e.getFullYear(),e.getMonth(),e.getDate())}function v(e,t){const n=Math.floor((t.getTime()-e.getTime())/864e5);return n>0?`+${n}`:`${n}`}var N=(e,t)=>{const n=e?"ONE_WAY":"ROUND_TRIP",a=e?"OW":"RT";return{onChangeEndDateCB:{id:`${n}_FC_onChangeEndDateCB`,description:"Returning date Change"},onChangeMonthCB:{id:`${n}_FC_onChangeMonthCB`,description:"Month changed"},onChangeStartDateCB:{id:`${n}_FC_onChangeStartDateCB`,description:"Departing date Change"},onOpenCB:{id:`${n}_FC_onOpenCB`,description:"Open Date Picker"},onDismissCB:{id:`${n}_FC_onDismissCB`,description:"Close Date Picker"},onSubmitCB:{id:`${n}_FC_onSubmitCB`,description:"Save Dates"},onDoneButtonCB:{id:"FLT.FareCalendar.Done",description:"Done Button Clicked"},onChangeFlexStartDateCB:{id:`FLT.${a}.FareCalendar.DateChange.OB.${t}`,description:"Outbound Date Change"},onChangeFlexEndDateCB:{id:`FLT.${a}.FareCalendar.DateChange.IB.${t}`,description:"Inbound Date Change"}}},M=h.gql`
  query FareCalendarQuery(
    $context: ContextInput!
    $journeyCriteria: [FlightsJourneyCriteriaInput!]!
    $flightsSearchContext: FlightsSearchContextInput!
  ) {
    flightsFareCalendar(context: $context, journeyCriteria: $journeyCriteria, flightsSearchContext: $flightsSearchContext) {
      disclaimerText
      priceLockupText
      coverageAnalytics {
        linkName
        referrerId
      }
      datePickerCellContents {
        date {
          formatted(format: "yyyy-MM-dd")
        }
        accessibility
        selectAnalytics {
          linkName
          referrerId
        }
        content {
          price {
            amount
            formatted
          }
          priceTheme
          valueText
        }
      }
    }
  }
`,P=()=>{const[e,t]=a.useState({datePickerContent:{},concatenatedResult:{}}),[n,r]=a.useState(""),[o,i]=a.useState(""),[l,c]=a.useState({}),[s,d]=a.useState({}),[C,g]=a.useState(!1),[D,y]=a.useState(""),[F,B]=a.useState(!1),{context:_}=(0,f.R)(),{formatDate:S}=(0,u.useLocalization)(),{error:T}=(0,m.useLogger)(),[E,{data:v,error:N}]=(0,h.useLazyQuery)(M,{ssr:!1,fetchPolicy:"no-cache"});a.useEffect(()=>{if(y(""),N&&T("FARE_CALENDAR_FETCH_ERROR"),(null==v?void 0:v.flightsFareCalendar)&&v.flightsFareCalendar.datePickerCellContents.length>0){const[n,a,o]=(e=>{const t={},n={},a={};return e.flightsFareCalendar.datePickerCellContents.map(e=>{var r;return t[null==(r=e.date)?void 0:r.formatted]={className:e.content.priceTheme.toLowerCase(),ariaLabel:e.accessibility,text:e.content.valueText},n[e.date.formatted]={analytics:{referrerId:e.selectAnalytics.referrerId,linkName:e.selectAnalytics.linkName}},a[e.date.formatted]={price:e.content.price?e.content.price.amount:e.content.valueText,priceWithCurrency:e.content.valueText},[t,n,a]}),[t,n,a]})(v);p()(e.datePickerContent,n)||t({datePickerContent:n,concatenatedResult:C?O(O({},e.concatenatedResult),n):n}),v.flightsFareCalendar.priceLockupText?(B(!0),y(v.flightsFareCalendar.priceLockupText)):(B(!1),y(v.flightsFareCalendar.disclaimerText)),r(v.flightsFareCalendar.coverageAnalytics.referrerId),i(v.flightsFareCalendar.coverageAnalytics.linkName),c(a),d(o)}},[v,N,T]);const P=(e,t)=>{const n=b(),a=e<n?n:e;let r=a;return t&&(r=function(e,t){const n=x(e),a=x(e);return a.setDate(n.getDate()+t),a}(S(e,{raw:"yyyy-MM-dd"}),14)),{departureDate:a,returnDate:r}};return[(e,n,a,r,o,i)=>{i||t({datePickerContent:{},concatenatedResult:{}}),g(i);const{departureDate:l,returnDate:c}=P(r,o);let s=[{departureDate:{day:l.getDate(),month:l.getMonth()+1,year:l.getFullYear()},destination:n,origin:e}];l!==c&&(s=[{departureDate:{day:l.getDate(),month:l.getMonth()+1,year:l.getFullYear()},destination:n,origin:e},{departureDate:{day:c.getDate(),month:c.getMonth()+1,year:c.getFullYear()},destination:e,origin:n}]);const u=k(O({},{context:_,journeyCriteria:s,flightsSearchContext:{tripType:a}}),{context:_});E({variables:u})},e.concatenatedResult,D,n,o,l,s,F]},R=(e=>(e.ONE_WAY="ONE_WAY",e.ROUND_TRIP="ROUND_TRIP",e.FLEX_DATE_ONE_WAY="OW",e.FLEX_DATE_ROUND_TRIP="RT",e))(R||{}),A=(e,t)=>e?t(e,{raw:"yyyy-MM-dd"}):"",L=e=>{const{destination:t,dateFieldProps:n,endDate:r,firstDayOfWeek:C,onChange:g,onMountCB:D,origin:p,singleMode:h,startDate:f,startDateName:m,tripType:y,onSubmitAnalytics:F,dialogWrapper:B,openDialog:_,dismissDialog:S,onOpenCB:T,autoOpen:E,onDoneButtonClickCB:M,singleTrigger:R}=e,[L,$,w,I,W,Y,U,j]=((e,t,n)=>{const[a,r,o,i,l,c,s,u]=P();return[(r,o,i)=>{a(e,t,n,r,o,i)},r,o,i,l,c,s,u]})(p,t,y),[H,K]=a.useState(!1),z=a.useRef(!1),q=a.useRef(!1),[J,Q]=a.useState(!1),[V,X]=a.useState(!1),[Z,G]=a.useState(!1),[ee,te]=a.useState(b()),[ne,ae]=a.useState(b()),[re,oe]=a.useState(""),{formatDate:ie}=(0,u.useLocalization)(),le=N(h),ce=(0,c.useClickTracker)(),se=e=>{ce(e.id,e.description)},ue=e=>{var t;const n=null==(t=U[A(e,ie)])?void 0:t.priceWithCurrency;oe(n&&"-"!==n?n:"")},de=()=>{h||(G(!0),L(ee,!0,!1),ue(ee))};(0,s._H)(d.Jm,d.ht,{onSuccess:()=>{K(!0)}});const Ce=e=>{S(e),se(le.onDismissCB),K(!1),z.current=!1},ge=(e,t)=>{var n,a;const r=A(e,ie),o=A(t,ie);return[{fieldName:"startDate",value:r,price:null==(n=U[r])?void 0:n.price},{fieldName:"endDate",value:o,price:null==(a=U[o])?void 0:a.price}]},De=(e,t,n)=>{if(e){const n=ge(e,t);g(n),G(!1),se(le.onSubmitCB)}(()=>{if(F){I&&W&&ce(I,W);const e="ONE_WAY"===y?ee:ne,t=A(e,ie);Y&&e&&Y[t]&&ce(Y[t].analytics.referrerId,Y[t].analytics.linkName)}})(),Ce(n)};a.useEffect(()=>{te(f?x(f):b()),ae(r?x(r):b()),ue(f?x(f):b())},[f,r]),a.useEffect(()=>{E&&(L(ee,!1,!1),K(!0))},[]),a.useEffect(()=>{h||ue(ne)},[ne,U]);const pe=o()(e=>{const t=A(e,ie);Z||z.current||(null==$?void 0:$[t])||!q.current||L(e,Z,!0),z.current&&(z.current=!1)},1e3),he=k(O({},n),{routerLinkWrapper:e=>a.createElement(a.Fragment,null,e),onChange:g,showDatePicker:n.showDatePicker?n.showDatePicker:H,endName:"endDate",startName:null!=m?m:"startDate"}),fe=A(new Date(ee.getFullYear(),ee.getMonth(),ee.getDate()),ie),me=V?fe:"",ye={buttonText:n.buttonText,currentPrice:re,dateFieldProps:he,datePickerContent:$,daysBookableInAdvance:330,dialogWrapper:B,doubleMonths:!0,singleDateSelect:!0,endDate:r?A(new Date(ne.getFullYear(),ne.getMonth(),ne.getDate()),ie):"",firstDayOfWeek:C,footerText:w,singleMode:h,midnightBookingOffset:4,onDismissCB:Ce,onOpenCB:(e,t)=>{_(e,t),Q(t),ue(f?x(f):b()),K(!0),se(le.onOpenCB),null==T||T(e),"end"===e?de():(L(new Date(ee.getFullYear(),ee.getMonth(),1),!1,!1),q.current=!0,z.current=!0)},onMountCB:D,onSubmitCB:De,onChangeMonthCB:e=>{Z&&"ROUND_TRIP"===y||L(e,Z,!1),se(le.onChangeMonthCB)},onChangeStartDateCB:e=>{te(e),h&&ue(e),h||(ne&&e>ne&&(ae(new Date(e.getFullYear(),e.getMonth(),e.getDate()+1)),q.current=!1),te(e),X(!0),G(!0),L(e,!0,!1)),se(le.onChangeStartDateCB);const t=N(h,v(ee,e));se(t.onChangeFlexStartDateCB)},onChangeEndDateCB:e=>{ae(e),G(!1),se(le.onChangeEndDateCB);const t=N(h,v(ne,e));se(t.onChangeFlexEndDateCB)},startDate:f?fe:me,onSelectEndModeCB:de,onScrollHandler:pe,onDoneButtonClickCB:(e,t)=>{De(e,t,J),se(le.onDoneButtonCB);const n=ge(e,t);null==M||M(e,n,t)},useSingleTrigger:R};return j?a.createElement(i.gs,O({},ye)):a.createElement(l.e5,O({},ye))},$=e=>{const[t,n,r]=(()=>{const[e,t,n]=(0,g.useDialog)("datepicker-start"),[r,o,i]=(0,g.useDialog)("datepicker-end");return[(t,o)=>"end"===o?a.createElement(C.K,{isVisible:r},a.createElement(i,null,a.createElement(a.Fragment,null,t))):a.createElement(C.K,{isVisible:e},a.createElement(n,null,a.createElement(a.Fragment,null,t))),(e,n)=>{n&&("end"===e?o.openDialog():t.openDialog())},e=>{e&&(r?o.closeDialog():t.closeDialog())}]})();return a.createElement(L,O({},k(O({},e),{dialogWrapper:t,openDialog:n,dismissDialog:r})))};$.displayName="FareCalendar"}}]);
//# sourceMappingURL=https://bernie-assets.s3.us-west-2.amazonaws.com/shopping-pwa/shared-ui-flights-fare-calendar.2003126f0f2271d10756.js.map