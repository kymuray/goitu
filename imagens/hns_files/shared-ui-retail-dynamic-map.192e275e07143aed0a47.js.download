/*@license For license information please refer to shared-ui-retail-dynamic-map.licenses.txt*/
(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[5616],{3511:function(e,t,n){n.d(t,{$s:function(){return de},JX:function(){return Z},Jh:function(){return te},LV:function(){return Qe},Qd:function(){return Te},Sp:function(){return Y},Uy:function(){return ae},Vw:function(){return se},XW:function(){return He},_c:function(){return he},dG:function(){return le},em:function(){return X},h0:function(){return be},kB:function(){return ne},kT:function(){return et},kq:function(){return ge},o2:function(){return ee},ot:function(){return J},sR:function(){return ie},we:function(){return ce}});var a=n(56195),l=n(9010),i=n(36145),o=n(87818),r=n(19716),s=n(53331),d=n(70667),c=n(64341),u=n(68478),p=n(53017),m=n(63085),v=n(97103),g=n(97778),f=n(78955),E=n(46559),y=n(26690),C=n(87552),h=n(99828),_=n(522),b=n(42534),M=n(19394),S=n(92919),T=n(24109),k=n(1226),I=n(47540),P=n(74071),N=n(27102),L=n(49858),w=n(51537),O=n(51213),A=n(95519),R=n(30169),D=n(5662),x=n(2557),B=n(34372),$=n(43888),F=n(934),z=n(89438),V=n(42048),G=n(4997),U=e=>{const t=1e6;return Math.round((e+Number.EPSILON)*t)/t},q=(e,t)=>`${e.map(U)}, ${t.map(U)}`,H=(e,t)=>e.listFeatures(e=>t(e)&&e.visible,e.getBounds()).length,K=(e,t,n)=>{var a,l,i,o,r,d,c,u;const p=null!=(a=(e=>{if(!e)return null;const[t,n]=e.ne,[a,l]=e.sw;return`POLYGON((${l} ${a}, ${n} ${a}, ${n} ${t}, ${l} ${t}, ${l} ${a}))`})(e.getBounds()))?a:"",[m,v]=null!=(l=e.getCenter())?l:[0,0];return{mapObj:{content_origin:t,visible_bounding_box:p,center_latitude:m,center_longitude:v,zoom_level:null!=(i=e.getZoom())?i:0},destination:{destination_geo_id:n},map_product_detail:{property_count:void 0!==n?e.listFeatures(e=>{var t;return!0===(null==(t=e.marker)?void 0:t.markerCutOff)},e.getBounds(),!0,!0).length:void 0,available_product_pin_count:null!=(o=H(e,e=>("property"===e.type||"product"===e.type)&&"available"===e.status))?o:0,sold_out_product_pin_count:null!=(r=H(e,e=>("property"===e.type||"product"===e.type)&&"sold_out"===e.status))?r:0,minipins_count:null!=(d=H(e,e=>{var t,n;return("property"===e.type||"product"===e.type)&&null!=(n=null==(t=e.qualifiers)?void 0:t.includes(s.lL.MINIPIN))&&n}))?d:0,product_cluster_count:null!=(c=H(e,e=>"cluster"===e.type))?c:0,ads_shown_count:null!=(u=H(e,e=>{var t,n;return"qualifiers"in e&&null!=(n=null==(t=e.qualifiers)?void 0:t.includes(s.lL.PINNED))&&n}))?u:0}}},j=e=>JSON.stringify(e),W={MAP_PRESENTED:new m.SystemEvent(m.SystemEventLevel.INFO,"MAP_PRESENTED"),MAP_PRESENTED_FAILED:new m.SystemEvent(m.SystemEventLevel.ERROR,"MAP_PRESENTED_FAILED"),MAP_INIT:new m.SystemEvent(m.SystemEventLevel.INFO,"MAP_INIT")},Z=e=>(null!=e?e:[]).map((e,t)=>{const n=(e.type||"place").toString().toLowerCase(),a=(e.markerStatus||"unknown").toString().toLowerCase();let l;(e.onSelectAccessibilityMessage||e.onEnterAccessibilityMessage)&&(l={default:e.onEnterAccessibilityMessage||"",onSelect:e.onSelectAccessibilityMessage||""});const i=e.text||void 0;return{id:e.id||`${n}-${t}`,name:e.name||void 0,lat:e.markerPosition.latitude,lng:e.markerPosition.longitude,type:n,status:a,qualifiers:[...e.qualifiers],text:Q(n)||X(n)&&"unknown"===a?i:void 0,price:X(n)&&"unknown"!==a?i:void 0,ariaLabels:l}}),X=e=>"property"===e||"product"===e,Q=e=>"place"===e,J=e=>"cluster"!==e.type,Y=e=>{var t;return null==(t=e.listFeatures(e=>{var t;return null==(t=e.qualifiers)?void 0:t.includes(s.lL.PINNED)}).filter(J))?void 0:t[0]},ee=(e,t)=>{var n;return null==(n=e.listFeatures(e=>X(e.type)&&e.id===t).filter(J))?void 0:n[0]},te=e=>{var t;return null==(t=e.listFeatures(e=>{var t;return null==(t=e.qualifiers)?void 0:t.includes(s.lL.FOCAL)}).filter(J))?void 0:t[0]},ne=e=>{var t;return null==(t=e.listFeatures(e=>{var t,n;return(null==(t=e.qualifiers)?void 0:t.includes(s.lL.SPOTLIGHT))&&!(null==(n=e.qualifiers)?void 0:n.includes(s.lL.CUSTOM))}).filter(J))?void 0:t[0]},ae=e=>{const{data:t,term:n}=e,{category:a,essId:l,location:{lat:i,long:o},regionId:r,regionNames:d,type:c,sourceId:u}=t,{sourceId:p,sourceName:m}=l||{},v="LCM"===m?"product":"place",g="GOOGLEMAPS"===a,f=g?`googlemaps-${u}`:r||(m?`${m}-${p}`:p),{name:E,description:y}=((e,t,n)=>{var a;let l;return l="AIRPORT"===n?t||e?[t||e]:[]:null!=(a=null==e?void 0:e.split(", "))?a:[],{name:l.shift(),description:l.join(", ")}})(null==d?void 0:d.fullName,null==d?void 0:d.shortName,c),C=[s.lL.SPOTLIGHT,s.lL.CUSTOM];return l&&C.push(s.lL.ESS),g&&C.push(s.lL.GOOGLE),{id:f,lat:+i,lng:+o,name:E,type:v,status:"unknown",qualifiers:C,text:n,description:y,score:1,ariaLabels:{default:E,onSelect:E}}},le=(e,t,n,a,l)=>{const i=a?{centeredOn:[a.latitude,a.longitude]}:void 0,o=(n?[...t,n]:t).filter(e=>void 0!==e.lat&&void 0!==e.lng).filter(e=>!(({qualifiers:e})=>!!(null==e?void 0:e.find(e=>"transport__airport"===e)))(e)).map(e=>[e.lat||0,e.lng||0]);e.boundsContaining(o,!0,i).then(({sw:t,ne:a})=>{e.fitBounds(t,a,!0,null!=l?l:"0px 0px 20%"),e.selectFeature(n.id,n.type)})},ie=(e,t)=>{if(null==t?void 0:t.includes("%"))return t;let n;n=void 0===e?"0px":"number"==typeof e?`${e}px`:String(e);const a=(null!=t?t:"").trim().split(/\s+/).filter(Boolean),[l="0px",i="0px",o="0px",r="0px"]=a,s=l;let d=i,c=o,u=r;switch(a.length){case 1:d=s,c=n,u=s;break;case 2:case 3:c=n,u=d;break;default:c=n}return`${s} ${d} ${c} ${u}`},oe="Interaction",re="Impression",se=({eventName:e,eventType:t,eventVersion:n,eventCategory:a,actionLocation:l,pageName:i,actionReason:o})=>{const r={event_name:e,event_type:t,event_version:n,event_category:a||"maps",action_reason:o};return l&&(r.action_location=l),i&&(r.page_name=i),o&&(r.action_reason=o),r},de=(e,t)=>({...t,event:e});function ce(){const e=(0,g.useEgClickstream)(),t=t=>{e&&e(t)},n=e=>{const{id:t,name:n,text:a,qualifiers:l}=e,i=null==l?void 0:l.includes(s.lL.GOOGLE),o=n||a||t.toString();return{map_obj:{map_feature_id:t,map_search_type:i?"google":"gaia",map_search_detail:o}}},a=(0,g.useClickTracker)();return{trackMapInit:(e,n)=>{const a=se({eventName:"map.initiated",eventType:oe,eventVersion:"2.3.0"});t(de(a,{map_obj:{map_provider:e,map_selection_type:"product",map_selection_id:n}}))},trackMapPresented:(e,n,a)=>{const l=se({eventName:"map.presented",eventType:re,eventVersion:"2.4.0"});t(de(l,{map_obj:{map_identifier:n,visible_bounding_box:e,view_mode:a}}))},trackMapViewportMoved:(e,n,a)=>{const l=se({eventName:"map_viewport.viewed",eventType:oe,eventVersion:"3.2.0"});t(de(l,{map_obj:{visible_bounding_box:e,movement_type:n,zoom_level:a}}))},trackMapContentPresented:e=>{const n=se({eventName:"map_content.presented",eventType:re,eventVersion:"4.6.0"}),a={map_obj:e.mapObj,destination:e.destination,map_product_detail:e.map_product_detail};t(de(n,a))},trackMapPlaceSelected:(e,n,a,l)=>{const i=se({eventName:"map_place.selected",eventType:oe,eventVersion:"3.10.1"});t(de(i,{map_obj:{map_selection_id:e,map_selection_type:l,geometry_type_name:n,qualifiers:a}}))},trackMapProductSelected:(e,n,a)=>{const l=se({eventName:"map_product.selected",eventType:oe,eventVersion:"2.13.0"});t(de(l,{map_obj:{map_selection_id:e,map_selection_type:a,qualifiers:n}}))},trackMapHidden:()=>{const e=se({eventName:"map.hidden",eventType:oe,eventVersion:"2.3.0"});t(de(e,{}))},trackMapFilterChanged:(e,t)=>{a(e,t)},trackMapCustomPlaceAdded:(e,a,l)=>{const i=se({eventName:"map_place.added",eventType:oe,eventVersion:"1.0.0",actionLocation:a,pageName:l}),o=n(e);t(de(i,o))},trackMapCustomPlaceRemoved:(e,a,l)=>{const i=se({eventName:"map_place.removed",eventType:oe,eventVersion:"1.0.0",actionLocation:a,pageName:l}),o=n(e);t(de(i,o))},trackMapDialogOpened:(e,n)=>{const a=se({eventName:"map_dialog.opened",eventType:oe,eventVersion:"1.0.0",actionLocation:e,pageName:n});t(de(a,{}))},trackMapDialogClosed:(e,n)=>{const a=se({eventName:"map_dialog.closed",eventType:oe,eventVersion:"1.0.0",actionLocation:e,pageName:n});t(de(a,{}))},trackBaseMapClicked:e=>{const t="Map.Basemap.Clicked";a(t,t)},trackMapMessagePresented:e=>{const n=se({eventName:"map_message.presented",eventType:re,eventVersion:"2.4.0",actionLocation:void 0,pageName:void 0,actionReason:e});t(de(n,{}))},trackMapProductCardSelected:()=>{const e=se({eventName:"map_product_card.selected",eventType:oe,eventVersion:"1.0.0"});t(de(e,{}))},trackMapZoomOutApplied:()=>{const e=se({eventName:"map_zoom_out.applied",eventType:oe,eventVersion:"1.0.0"});t(de(e,{}))},trackMapZoomInApplied:()=>{const e=se({eventName:"map_zoom_in.applied",eventType:oe,eventVersion:"1.0.0"});t(de(e,{}))},trackMapDragApplied:()=>{const e=se({eventName:"map_drag.applied",eventType:oe,eventVersion:"1.0.0"});t(de(e,{}))},trackMapRadiusToggleSelected:e=>{const n=se({eventName:"map_radius_toggle.selected",eventType:oe,eventVersion:"1.3.1",eventCategory:"Search"});t(de(n,{additional_context:{user_interface:{component_element_name:!0===e?"on":"off"}}}))},trackMapRadiusTimeSelected:e=>{const n=se({eventName:"map_radius_time.selected",eventType:oe,eventVersion:"1.3.1",eventCategory:"Search"});t(de(n,{additional_context:{user_interface:{component_element_name:e}}}))},trackMapRadiusModeSelected:e=>{const n=se({eventName:"map_radius_mode.selected",eventType:oe,eventVersion:"1.3.1",eventCategory:"Search"});t(de(n,{additional_context:{user_interface:{component_element_name:e}}}))}}}var ue=y.gql`
  fragment CustomPlaceFragment on CustomPlaceWithAnalytics {
    addPlaceAnalytics
    removePlaceAnalytics
    openDialogAnalytics
    closeDialogAnalytics
    toastPresentedAnalytics
    placeSelectedAnalytics
    typeaheadInput {
      label
      leftIcon {
        id
        title
        description
        __typename
      }
      readOnly
      placeholder
      typeaheadInfo {
        proximityMaxMiles
        client
        isDestination
        personalize
        regionType
        regionId
        latlongSearchCenterPoint {
          latitude
          longitude
          __typename
        }
        __typename
      }
      __typename
    }
    __typename
  }
`,pe=y.gql`
  fragment DynamicMapFragment on EGDSBasicMap {
    label
    initialViewport
    center {
      latitude
      longitude
    }
    zoom
    bounds {
      northeast {
        latitude
        longitude
      }
      southwest {
        latitude
        longitude
      }
    }
    computedBoundsOptions {
      coordinates {
        latitude
        longitude
      }
      gaiaId
      lowerQuantile
      upperQuantile
      marginMultiplier
      minMargin
      minimumPins
      interpolationRatio
    }
    centeredBoundsOptions {
      centeredOn {
        latitude
        longitude
      }
      coordinates {
        latitude
        longitude
      }
    }
    config {
      ... on EGDSDynamicMapConfig {
        accessToken
        egdsMapProvider
        externalConfigEndpoint {
          value
        }
        externalConfigContent
        mapId
      }
    }
    markers {
      ... on EGDSMapFeature {
        id
        description
        markerPosition {
          latitude
          longitude
        }
        type
        markerStatus
        qualifiers
        text
        name
        clientSideAnalytics {
          linkName
          referrerId
        }
        onSelectAccessibilityMessage
        onEnterAccessibilityMessage
      }
    }
    customPlace {
      ...CustomPlaceFragment
    }
    tnlFields {
      ... on EGDSBaseMapKeyValuePair {
        key
        value
      }
    }
  }
  ${ue}
`,me=(e,t)=>{const n={},a=new Set(t),l=(e,t)=>{a.has(e)&&!(e in n)&&(n[e]=t)},i=e=>{for(const a in e)if(Object.prototype.hasOwnProperty.call(e,a)){if(l(a,e[a]),Object.keys(n).length===t.length)return;"object"==typeof e[a]&&null!==e[a]&&i(e[a])}};return i(e),n},ve=e=>{if(null==e?void 0:e.text)return{term:e.text,feature:e}},ge=e=>{var t;const{customFeatureUpdated:n,typeaheadLogger:l,regionCoordinates:i,regionId:o,predefinedPlace:r,typeaheadInput:s,openDialogAnalytics:d,closeDialogAnalytics:u,essAdapterPageId:p="",children:m,findAPlaceIsVisible:g=!1,setFindAPlaceIsVisible:E,setSavedFeature:y,resultsRenderType:h=f.W.ADAPTIVE,className:_}=e,{label:b="",leftIcon:M,placeholder:S}=s||{},{client:T,typeaheadFeatures:k,maxNumberOfResults:I,regionType:P,isDestination:N,personalize:L,lineOfBusiness:w,packageType:O,latlongSearchCenterPoint:A,proximityMaxMiles:R}=(null==s?void 0:s.typeaheadInfo)||{},{trackMapDialogOpened:D,trackMapDialogClosed:x,trackMapCustomPlaceAdded:B,trackMapCustomPlaceRemoved:$}=ce(),F=a.useRef(!1),z=a.useRef(!0),{context:V}=(0,c.R)(),{identity:G,locale:U,siteId:q}=V,H=Number(null==G?void 0:G.expUserId)||-1,{duaid:K}=G||{},j=!0,W=null!=k?k:"consistent_display|ta_hierarchy|contextual_ta|google",[Z,X]=a.useState(ve(r)),Q=A||{},{latitude:J=null,longitude:Y=null}=Q,ee="tripsmap"!==T,te=new C.Z({client:T||"default-map-places-client",domain:void 0,dest:null==N||N,expuserid:H,features:W,guid:K,lob:null!=w?w:"HOTELS",locale:U,maxResults:null!=I?I:10,regionType:null!=P?P:1787,personalize:L||!1,siteId:q,regionId:o,typeaheadLogger:l,fetchLocation:j,googleApiVersion:null==(t=(0,v.I)())?void 0:t.version,latLong:i,xPageId:p,packageType:null!=O?O:void 0,...J&&Y?{latlongSearchCenterPoint:`${J},${Y}`}:{},...R?{proximityMaxMiles:R}:{}}),ne=a.useCallback(e=>{const{data:t}=e;if(t){const t=ae(e);B(t),F.current=!0,X(ve(t)),y&&y(t)}},[B]),le=a.useCallback(()=>{(null==Z?void 0:Z.feature)&&ee&&$(Z.feature),X(void 0),y&&y(void 0)},[Z,$]);a.useEffect(()=>{z.current?n&&(null==Z?void 0:Z.feature)&&(n(null==Z?void 0:Z.feature),z.current=!1):n&&n(null==Z?void 0:Z.feature)},[n,Z]);const ie=a.useCallback(()=>{var e,t;if(F.current=!1,d){const n=JSON.parse(d),a=me(n,["action_location","page_name"]);D(null!=(e=a.action_location)?e:void 0,null!=(t=a.page_name)?t:void 0)}},[]),oe=a.useCallback(()=>{var e,t;if(E&&E(!1),u){const n=JSON.parse(u),a=me(n,["action_locations","page_name"]);F.current||x(null!=(e=a.action_location)?e:void 0,null!=(t=a.page_name)?t:void 0)}},[]);return a.createElement(f.B,{id:"placesTypeAhead",className:_,stid:"typeahead-adaptive",adapter:te,icon:null==M?void 0:M.id,label:b,name:"customPlacesTypeAhead",typeaheadPlaceholder:S,typeaheadEmptyResultPlaceholder:(null==s?void 0:s.typeaheadEmptyResultPlaceholder)||"",onUpdate:ne,renderType:h,value:null==Z?void 0:Z.term,handleClear:le,onClick:ie,onDismiss:oe,hasClearButton:!0,triggerComponentWidth:"327px",customTrigger:m?{showTypeahead:g}:void 0},m)};ge.displayName="PlacesTypeahead";var fe=(e,t)=>({TOP_LEFT:{type:"absolute",position:{..."ltr"===t?{left:"three"}:{right:"three"},top:"three",zindex:"layer1"}},BOTTOM_CENTER:{type:"absolute",position:{left:"center",bottom:"twelve",zindex:"layer1"}}}[e]),Ee=e=>{var t,n;const{customFeatureUpdated:l,customPlaceInfo:i,viewportProps:r,essAdapterPageId:s,predefinedPlace:d}=e,{typeaheadInput:c}=i||{},u=null==(n=null==(t=null==i?void 0:i.typeaheadInput)?void 0:t.typeaheadInfo)?void 0:n.regionId,{md:p,sm:m}=r,[v,g]=a.useState("ltr");return a.useEffect(()=>{const e=document.documentElement.getAttribute("dir")||"ltr";g(e)},[]),a.createElement(E.LM,null,a.createElement(E.rw,null,a.createElement(o.P,{key:"places-typeahead",...fe(p,v),cloneElement:!0},a.createElement(ge,{essAdapterPageId:s,typeaheadInput:c,customFeatureUpdated:l,regionId:null!=u?u:"",openDialogAnalytics:null==i?void 0:i.openDialogAnalytics,closeDialogAnalytics:null==i?void 0:i.closeDialogAnalytics,resultsRenderType:(y=p,"TOP_LEFT"===y?f.W.ADAPTIVE:f.W.DIALOG),predefinedPlace:d}))),a.createElement(E.NP,null,a.createElement(o.P,{key:"places-typeahead",...fe(p,v),cloneElement:!0},a.createElement(ge,{essAdapterPageId:s,typeaheadInput:c,customFeatureUpdated:l,regionId:null!=u?u:"",openDialogAnalytics:null==i?void 0:i.openDialogAnalytics,closeDialogAnalytics:null==i?void 0:i.closeDialogAnalytics,resultsRenderType:f.W.DIALOG,predefinedPlace:d}))));var y};Ee.displayName="sharedui-CustomPlace",Ee.fragment=ue;var ye={BOTTOM_CENTER:{spacing:{margin:{inline:"three",blockend:"three"}},layoutPosition:{position:{bottom:"zero"}},layoutPositionStyle:{width:"calc(100% - 1.5rem)"}},TOP_RIGHT:{spacing:{margin:{inline:"one"}},layoutPosition:{position:{right:"zero",top:"zero"}},layoutPositionStyle:{top:"170px",right:"2px"}}},Ce=e=>{const{zIndex:t,children:n,position:l="BOTTOM_CENTER",cardId:i}=e,{spacing:r,layoutPosition:s,layoutPositionStyle:d}=ye[l],c={...d,zIndex:t};return a.createElement(b.N,{...r},a.createElement(o.P,{type:"absolute",tag:"div",pointerEvents:"none",style:c,...s},a.createElement("div",{id:`floating-card-panel-${i}`},a.createElement(_.X,{justifyContent:"center",direction:"column"},n))))};Ce.displayName="sharedui-FloatingCard";var he=(e=>(e.BOTTOM_CENTER="BOTTOM_CENTER",e.TOP_RIGHT="TOP_RIGHT",e))(he||{}),_e=({children:e})=>{const t=a.useCallback((e=[])=>{const t=new Map;return e.forEach(e=>{var n;const{zIndex:a,position:l}=e.props,i=`${l}-${a}`;t.has(i)?null==(n=t.get(i))||n.push(e):t.set(i,[e])}),[...t.values()].map((e,t)=>{var n;if((null==e?void 0:e.length)>0){const{zIndex:l,position:i}=(null==(n=e[0])?void 0:n.props)||{},o=e.map((e,t)=>{const{overlayElementId:n,alignSelf:l,grow:i,maxWidth:o}=e.props,r={alignSelf:l,grow:i,maxWidth:o};return a.createElement(h.C,{...r,style:{width:"100%"},key:`overlay-element-${t}`},a.createElement("div",{id:n,tabIndex:-1,style:{pointerEvents:"all"}},e))});return a.createElement(Ce,{cardId:`${t}`,key:`floating-card-${t}`,zIndex:l,position:i},o)}return null})},[]),n=a.useMemo(()=>{const n=[],l=[],i=(e,t,n)=>{if(e.type===a.Fragment&&void 0!==e.props.children.map){const l=[];e.props.children.map(e=>i(e,t,l)),l.length>0&&n.push(a.createElement(a.Fragment,null,l))}else a.isValidElement(e)&&e.props.overlayElementId?t.push(e):n.push(e)};return a.Children.toArray(e).forEach(e=>{i(e,n,l)}),[...t(n),...l]},[e,t]);return a.createElement(a.Fragment,null,n)};_e.displayName="sharedui-MapOverlay";var be=({children:e,...t})=>a.createElement(a.Fragment,null,e);be.displayName="sharedui-OverlayElement";var Me=e=>{const{placeId:t,directionsTo:n,...l}=e;return a.createElement(E.LM,null,a.createElement(E.NP,null,a.createElement(M.S3,{size:M.$Q.COMPACT,...l,inputs:{placeId:t,directionsTo:n}})),a.createElement(E.rw,null,a.createElement(M.S3,{size:M.$Q.STANDARD,...l,inputs:{placeId:t,directionsTo:n}})))};Me.displayName="sharedui-MapPlaceCard";var Se=y.gql`
  fragment MapCardContentFragment on EGDSImageCard {
    imageCardId: id
    title
    subTitle
    description
    image {
      aspectRatio
      description
      thumbnailClickAnalytics {
        eventType
        linkName
        referrerId
        uisPrimeMessages {
          messageContent
          schemaName
        }
      }
      url
    }
  }
`,Te=e=>{const{data:t,size:n,imageRatio:o}=e;if(!t||!t.title)return null;const{image:r,subTitle:s,title:d,imageCardId:c,description:u}=t,p=o||1===n?l.l.R3_4:l.l.R4_3,m=1===n?296:552;return a.createElement(S.g,null,a.createElement("div",{"data-testid":`map-card-${c}`}),a.createElement(k.w,{alignItems:"start",columns:4,style:{minHeight:63,minWidth:m}},r?a.createElement(I.T,{colSpan:1},a.createElement(l.M,{ratio:p,roundcorner:["startstart"]},a.createElement(i.F,{src:r.url,alt:r.description,placeholderImage:!0}))):null,a.createElement(I.T,{colSpan:r?3:4},a.createElement(_.X,{direction:"column",blockSize:"full_size",justifyContent:"space-between"},a.createElement(h.C,null,a.createElement(T.E,null,a.createElement(P.M,null,d),u?a.createElement(N.D,{size:200,spacing:"one"},u):null)),a.createElement(h.C,null,a.createElement(T.E,null,s?a.createElement(N.D,{size:200},s):null))))))};Te.fragment=Se,Te.displayName="sharedui-MapCardContent";var ke=({aspectRatio:e,className:t})=>a.createElement(l.M,{ratio:e,className:t},a.createElement(L.R,{type:"block"}));ke.displayName="CardGallerySkeleton";var Ie=()=>a.createElement(a.Fragment,null,a.createElement(b.N,{margin:{blockend:"two"}},a.createElement(L.R,{type:"line",animation:!0,lineLength:"primary"})),a.createElement(b.N,{margin:{blockend:"two"}},a.createElement(L.R,{type:"line",animation:!0,lineLength:"secondary"})));Ie.displayName="CardTextSkeleton";var Pe=()=>a.createElement(T.E,null,a.createElement(Ie,null));Pe.displayName="CardContentSkeleton";var Ne=({view:e,id:t})=>{const{formatText:n}=(0,O.useLocalization)();return(0,a.useEffect)(()=>{var e;const t=null!=(e=n("maps.card.property.content.loading"))?e:"Property content is loading";(0,w.liveAnnounce)(t,w.Level.ASSERTIVE)},[t]),"COMPACT_HORIZONTAL"===e?a.createElement(S.g,null,a.createElement(k.w,{columns:3},a.createElement(I.T,{colSpan:1},a.createElement(ke,{aspectRatio:l.l.R21_9,className:"uitk-card-roundcorner-top-left uitk-card-roundcorner-bottom-left"})),a.createElement(I.T,{colSpan:2},a.createElement(b.N,{padding:{blockend:"twelve"}},a.createElement(Pe,null))))):null};Ne.displayName="MapCardPlaceholder";var Le=e=>{const{data:t,LodgingCard:n,LodgingCardView:l,onClickScrollToView:i,onClickCallback:o,onCardDismiss:r,showDismissButton:s,tnlFields:d=[],productId:c,isMapCardPlaceHolderVisible:u}=e;return u?a.createElement(Ne,{view:"COMPACT_HORIZONTAL",id:c}):t&&"EGDSImageCard"===t.__typename?a.createElement(E.LM,null,a.createElement(E.NP,null,a.createElement(Te,{data:t,size:1})),a.createElement(E.rw,null,a.createElement(Te,{data:t,size:0}))):n&&l?a.createElement(n,{data:t,onClickScrollToView:i,onClickCallback:o,view:l.COMPACT_HORIZONTAL,headingOverflow:s?"truncate-2-lines":"wrap",onCardDismiss:r,showDismissButton:s,fireImpressionByViewability:!0,enableInlineLink:!0,placement:"Map",tnlFields:d}):null};Le.displayName="sharedui-MapLodgingCard";var we=e=>a.createElement(M.gH,{photoMaxWidth:416,...e});we.displayName="sharedui-BaseGoogleMapPlaceCard";var Oe="egtnl60577_",Ae="proximity",Re=(e,t)=>{var n;return null==(n=e.find(e=>e.key===t))?void 0:n.value},De=(e,t)=>{var n;const a=null==(n=e.find(e=>e.key===t))?void 0:n.value;if(void 0===a)throw new Error(`TNL field with key "${t}" not found but a value is required`);return a},xe=e=>{let t=0,n=!1;for(;!n;)void 0===Re(e,`${Oe}mode${t}Polygon0`)?n=!0:t+=1;return t},Be=(e,t)=>{let n=0,a=!1;for(;!a;)void 0===Re(t,`${Oe}mode${e}Polygon${n}`)?a=!0:n+=1;return n},$e=e=>e.some(e=>e.key.startsWith(Oe)),Fe=(e,t)=>({defaultDuration:Number(De(t,`${Oe}mode${e}defaultDuration`)),announce:De(t,`${Oe}mode${e}Announce`),estimatedLabel:De(t,`${Oe}mode${e}EstimatedLabel`),buttonLabel:De(t,`${Oe}mode${e}ButtonLabel`),buttonSR:De(t,`${Oe}mode${e}ButtonSR`),iconName:De(t,`${Oe}mode${e}defaultIcon`),durationsInfo:[...Array(Be(e,t)).keys()].map(n=>((e,t,n)=>({durationLabel:De(n,`${Oe}mode${e}Duration${t}Label`),durationSR:De(n,`${Oe}mode${e}Duration${t}SR`)}))(e,n,t))}),ze={SMALL:{margin:0,width:"100%"},MEDIUM:{marginLeft:"auto",marginRight:"auto",maxWidth:"50%"}},Ve=({closeButtonSR:e,onClick:t})=>a.createElement(o.P,{type:"absolute",position:{top:"two",right:"two"}},a.createElement(A.q,{type:"button","aria-label":e,onClick:t},a.createElement(x.LD,{name:"close","aria-hidden":"true",size:x.So.MEDIUM}))),Ge=a.forwardRef((e,t)=>{var n,l,i,o,r,s;const{settings:d,onProximityChange:c,size:u,styleBySize:p}=e,{defaultMode:m,modes:v,closeButtonSR:g,disableTravelTimeSR:f,editButtonLabel:E,editButtonSR:y,enableTravelTimeSR:C,showSwitchLabel:M,showSwitchSublabel:k,transitTimeOffLabel:I,transitTimeSelectLabel:L,transitTimeSelectSR:O}=d,{trackMapRadiusToggleSelected:A,trackMapDialogOpened:G,trackMapDialogClosed:U,trackMapRadiusTimeSelected:q,trackMapRadiusModeSelected:H}=ce(),[K,j]=a.useState(!1),[W,Z]=a.useState(!0),[X,Q]=a.useState(m),[J,Y]=a.useState((null==(n=v[m])?void 0:n.defaultDuration)||0),[ee,te]=a.useState(),ne=a.useRef(null);a.useImperativeHandle(t,()=>({toggleProximityExpansion:()=>{K&&j(e=>!e)}})),a.useEffect(()=>{var e,t,n,a;c({mode:X,duration:J}),te(null==(a=null==(e=v[X])?void 0:e.announce)?void 0:a.replace("{increment}",(null==(n=null==(t=v[X])?void 0:t.durationsInfo[J])?void 0:n.durationLabel)||""))},[]),a.useEffect(()=>{(0,w.liveAnnounce)(ee||"",w.Level.ASSERTIVE)},[ee]);const ae=a.useCallback(e=>{var t,n,a,l,i;Q(e),(null==(t=v[e])?void 0:t.buttonLabel)&&H(v[e].buttonLabel),c({mode:e,duration:J}),te(null==(i=null==(n=v[e])?void 0:n.announce)?void 0:i.replace("{increment}",(null==(l=null==(a=v[e])?void 0:a.durationsInfo[J])?void 0:l.durationLabel)||""))},[v,c]),le=a.useCallback(e=>{var t,n,a,l,i,o;Y(e),c({mode:X,duration:e}),(null==(n=null==(t=v[X])?void 0:t.durationsInfo[e])?void 0:n.durationLabel)&&q(v[X].durationsInfo[e].durationLabel),te(null==(o=null==(a=v[X])?void 0:a.announce)?void 0:o.replace("{increment}",(null==(i=null==(l=v[X])?void 0:l.durationsInfo[e])?void 0:i.durationLabel)||""))},[X,c]),ie=a.useMemo(()=>a.createElement(h.C,{grow:1},a.createElement(b.N,{margin:{blockstart:"three"}},a.createElement(_.X,{direction:"row",space:"three",blockSize:"full_size"},v.map((e,t)=>a.createElement(h.C,{key:t,grow:1},a.createElement(D.c,{onClick:()=>ae(t),labelText:e.buttonLabel,"aria-label":e.buttonSR,icon:e.iconName,checked:t===X,stacked:!0})))))),[v,X]),oe=a.useMemo(()=>{var e;return a.createElement(h.C,{grow:1},a.createElement(B._,{label:L,"aria-label":O,onChange:e=>le(Number(e.target.value))},null==(e=v[X])?void 0:e.durationsInfo.map((e,t)=>a.createElement("option",{key:`duration-${t}`,value:t,selected:t===J,"aria-selected":t===J,"aria-label":e.durationSR},e.durationLabel))))},[v,X,J,le]),re=a.useCallback(()=>{var e,t,n,a;Z(!W),A(!W),W?(c(void 0),te(void 0)):(c({mode:X,duration:J}),te(null==(a=null==(e=v[X])?void 0:e.announce)?void 0:a.replace("{increment}",(null==(n=null==(t=v[X])?void 0:t.durationsInfo[J])?void 0:n.durationLabel)||"")))},[W,X,J,c]),se=a.createElement(_.X,{direction:"column",blockSize:"full_size",justifyContent:"space-between"},a.createElement(b.N,{margin:{blockstart:"two"}},a.createElement("div",null,a.createElement(b.N,{margin:{blockstart:"six"}},a.createElement(_.X,{direction:"column",blockSize:"full_size",space:"three"},a.createElement(h.C,{grow:1},a.createElement(V.Y,{switchPosition:"trailing",checked:W,label:M,description:k,a11yLabel:W?f:C,onChange:()=>re()})),W?a.createElement(a.Fragment,null,ie,oe):null)))));a.useEffect(()=>{K?G():U()},[K]);const de=a.createElement($.K,{isVisible:K},a.createElement(F.t,{type:"bottom",isVisible:K,triggerRef:ne,style:{position:"fixed"}},a.createElement(z.Y,null,a.createElement(Ve,{onClick:()=>j(!1),closeButtonSR:g}),se))),ue=null!=(l=null==p?void 0:p[u])?l:ze[u],pe=K?a.createElement(S.g,{style:ue},a.createElement(T.E,null,a.createElement(b.N,{margin:{block:"three",inline:"three"}},a.createElement("div",null,a.createElement(Ve,{onClick:()=>j(!1),closeButtonSR:g}),se)))):null,me=a.createElement(S.g,{style:ue},a.createElement(T.E,null,a.createElement(_.X,{direction:"column",blockSize:"full_size",justifyContent:"space-between"},a.createElement(_.X,{direction:"row",blockSize:"full_size",justifyContent:"end",space:"two",alignItems:"center"},a.createElement(h.C,{grow:1},a.createElement(P.M,{size:7},null==(i=v[X])?void 0:i.estimatedLabel)),W?a.createElement(x.LD,{name:(null==(o=v[X])?void 0:o.iconName)||"report",size:x.So.SMALL,"aria-hidden":"true"}):null,a.createElement(N.D,{size:300},W?null==(s=null==(r=v[X])?void 0:r.durationsInfo[J])?void 0:s.durationLabel:I),a.createElement(R.y,{onClick:()=>j(!0),"aria-label":y,domRef:ne},E)))));return"SMALL"===u?a.createElement(a.Fragment,null,me,de):K?pe:me}),Ue=a.forwardRef((e,t)=>{const{size:n,data:l,...i}=e,o=(0,m.useLoggerEvents)({INITIALIZATION_ERROR:new m.SystemEvent(m.SystemEventLevel.ERROR,"INITIALIZATION_ERROR")});if(!l||!$e(l))return null;let r;try{s=l,r={defaultMode:Number(De(s,`${Oe}defaultMode`)),modes:[...Array(xe(s)).keys()].map(e=>Fe(e,s)),showSwitchLabel:De(s,`${Oe}showSwitchLabel`),showSwitchSublabel:De(s,`${Oe}showSwitchSublabel`),enableTravelTimeSR:De(s,`${Oe}enableTravelTimeSR`),disableTravelTimeSR:De(s,`${Oe}disableTravelTimeSR`),editButtonLabel:De(s,`${Oe}editButtonLabel`),editButtonSR:De(s,`${Oe}editButtonSR`),closeButtonSR:De(s,`${Oe}closeButtonSR`),transitTimeOffLabel:De(s,`${Oe}transitTimeOffLabel`),transitTimeSelectLabel:De(s,`${Oe}transitTimeSelectLabel`),transitTimeSelectSR:De(s,`${Oe}transitTimeSelectSR`)},(e=>{if(0===e.modes.length)throw new Error("No modes defined in proximity dialog settings but at least one is required")})(r)}catch(d){return o.INITIALIZATION_ERROR.log(JSON.stringify({error:d instanceof Error?d.message:"Unknown error"})),null}var s;return n?a.createElement(Ge,{size:n,settings:r,...i}):a.createElement(E.LM,null,a.createElement(E.NP,null,a.createElement(Ge,{size:"SMALL",settings:r,...i,ref:t})),a.createElement(E.rw,null,a.createElement(Ge,{size:"MEDIUM",settings:r,...i,ref:t})),a.createElement(E.zQ,null,a.createElement(Ge,{size:"MEDIUM",settings:r,...i,ref:t})))});Ge.displayName="shared-ui-GeneralProximityDialog",Ue.displayName="shared-ui-ProximityDialog";var qe=a.forwardRef((e,t)=>a.createElement(Ue,{styleBySize:{SMALL:{margin:"12px 12px 12px",width:"calc(100% - 24px)"},MEDIUM:{margin:"12px 0px 12px",marginLeft:"auto",marginRight:"auto",maxWidth:"calc(50% + 24px)"}},...e,ref:t}));qe.displayName="sharedui-MapProximityDialog";var He=(e=>(e.MAP_CLICK="MAP_CLICK",e.CARD_CLOSE_BUTTON="CARD_CLOSE_BUTTON",e.FEATURE_MISSING="FEATURE_MISSING",e.KEYBOARD="KEYBOARD",e.UNSPECIFIED="UNSPECIFIED",e))(He||{}),Ke="trackMapViewportBoundChangedCb",je="trackMapContentPresentedId",We="googlePlaceContentId",Ze="showCardId",Xe=" keyPressedId",Qe=200,Je={contentProvider:{place:{google:["PoiGooglePlacesApi"]},providers:{PoiGooglePlacesApi:{type:"GooglePlacesApi",fields:["displayName","photos","primaryTypeDisplayName","rating","userRatingCount","regularOpeningHours","priceRange"],callType:"rest",maxPhotos:5}}}},Ye={googleMaps:{useAdvancedMarkers:!0},map:{baseMapMarkersClick:{enabled:!0,createMarkerOnSelection:!0,waitForContent:!1}},...Je},et=({children:e,data:t,className:n,beforeInit:g,onInit:f,initialViewport:E,initialMapConfig:y,supplementalFeatures:C,onFeaturesPushed:h,egMapsConfig:_,selectedFeatureId:b,selectedFeature:M,viewMode:S,egDistancesEnabled:T=!1,clientPadding:k,height:I="100vh",updateViewport:P=!0,onViewportUpdatedFromData:N,destinationGeoId:L,staticMapImgUrl:w,baseMapPoiClickable:O,cardsManagementHooks:A,customFeatureUpdated:R,essAdapterPageId:D,onProximityPolygonChanged:x,predefinedPlaceTypeahead:B,pageName:$="SRP"})=>{var F,z,V;const{initialViewport:U,center:H,zoom:Y,bounds:ee,computedBoundsOptions:te,centeredBoundsOptions:ne,config:ae,markers:le,tnlFields:ie}=t||{},oe=a.useRef(),re=a.useRef(null),se=a.useRef(!1),[de,ue]=a.useState(!1),[pe,me]=a.useState(null),ve=a.useRef(),[ge,fe]=a.useState(w),[ye,Ce]=a.useState(),[he,Se]=a.useState(),[Te,ke]=a.useState(void 0),[Ie,Pe]=a.useState(void 0),[Re,Fe]=a.useState(void 0),[ze,Ve]=a.useState(!1),[Ge,Ue]=a.useState(),[He,et]=a.useState(null),[tt,nt]=a.useState(null),at=a.useRef(void 0),[lt,it]=a.useState(!1),{trackEvent:ot}=(0,u.eS)(),{exposure:rt,logExperiment:st}=(0,p.useExperiment)("AA_test_Map_search_speed_metric_validation_v1",!0),{exposure:dt}=(0,p.useExperiment)("BEXH_SRP_Map_Defer_V2",!1);a.useEffect(()=>{w&&(oe.current||fe(w))},[w]);const{trackMapInit:ct,trackMapPresented:ut,trackMapViewportMoved:pt,trackMapContentPresented:mt,trackMapPlaceSelected:vt,trackMapProductSelected:gt,trackMapHidden:ft,trackBaseMapClicked:Et,trackMapProductCardSelected:yt,trackMapZoomInApplied:Ct,trackMapZoomOutApplied:ht,trackMapDragApplied:_t}=ce(),bt=(0,m.useLoggerEvents)(W),{context:{locale:Mt,currency:St,identity:Tt,clientInfo:kt}}=(0,c.R)();a.useEffect(()=>{se.current=P},[P]),a.useEffect(()=>{t&&(ve.current=t)},[t]);const It=a.useMemo(()=>{var e;return ae||(null==(e=ve.current)?void 0:e.config)||y},[y,ae]);a.useEffect(()=>ft,[]),a.useEffect(()=>{if(null==It?void 0:It.egdsMapProvider){const e="MAPBOX"===(null==It?void 0:It.egdsMapProvider)?"mapbox":"google-maps";st(rt),ct(e,b),bt.MAP_INIT.log(j({provider:e,selectedFeatureId:b,duaid:null==Tt?void 0:Tt.duaid,appName:null==kt?void 0:kt.name,[dt.name]:dt.bucket})),ot("action",{action:"map-initialized",attributes:{provider:e}})}},[null==It?void 0:It.egdsMapProvider]);const Pt=null==It?void 0:It.accessToken,Nt=a.useMemo(()=>O?Ye:Je,[O]),Lt=a.useMemo(()=>{if(It){const{mapId:t,egdsMapProvider:a,externalConfigEndpoint:l,externalConfigContent:i}=It,o=[_||{}];o.push(n?{additionalCssClass:n}:{}),o.push(Mt?{locale:Mt}:{}),o.push(St?{iso4217CurrencyCode:St}:{});const r=(null==l?void 0:l.value)?{externalConfigEndpoint:l.value}:{};try{const e=i?JSON.parse(i):null;o.push(null!=e?e:r)}catch(e){o.push(r)}if(o.push(Nt),t)if("MAPBOX"===a)o.push({mapbox:{mapboxAddConf:{style:t}}});else o.push({googleMaps:{gmapsAddConfig:{mapId:t}},contentProvider:{providers:{PoiGooglePlacesApi:{type:"GooglePlacesApi",restKey:Pt}}}});return o.push({markers:{place:{show:{[Ae]:!1}}}}),(0,G.k1)({},...o)}},[null==(F=null==It?void 0:It.externalConfigEndpoint)?void 0:F.value,null==It?void 0:It.mapId,null==It?void 0:It.egdsMapProvider,Mt,St,_,Pt,Nt]),wt=null==(z=(0,v.I)())?void 0:z.version,Ot="MAPBOX"===(null==It?void 0:It.egdsMapProvider)?s.Nw.MAPBOX:s.Nw.GOOGLE,At=(e=>{if(e===s.Nw.GOOGLE)return wt})(Ot),Rt=a.useMemo(()=>(e=>e?[...Array(xe(e)).keys()].flatMap(t=>[...Array(Be(t,e)).keys()].map(n=>({id:`proximity-${t}-${n}`,type:"place",status:"unknown",qualifiers:[Ae],polygon:JSON.parse(De(e,`${Oe}mode${t}Polygon${n}`))}))):[])(ie),[ie]),Dt=a.useMemo(()=>[...Z(null==le?void 0:le.map(e=>e)),...Rt,...C||[]],[le,Rt,C]),xt=a.useMemo(()=>null==Dt?void 0:Dt.map(e=>[e.lat,e.lng]),[Dt]),Bt=e=>({sw:[null==e?void 0:e.southwest.latitude,null==e?void 0:e.southwest.longitude],ne:[null==e?void 0:e.northeast.latitude,null==e?void 0:e.northeast.longitude]}),$t=(e,t)=>({center:[null==e?void 0:e.latitude,null==e?void 0:e.longitude],zoom:t}),Ft=(e,t)=>({useBoundsComputation:!0,options:{gaiaId:(null==t?void 0:t.gaiaId)&&!Number.isNaN(Number(null==t?void 0:t.gaiaId))?Number(null==t?void 0:t.gaiaId):void 0,lowerQuantile:null==t?void 0:t.lowerQuantile,upperQuantile:null==t?void 0:t.upperQuantile,marginMultiplier:null==t?void 0:t.marginMultiplier,minMargin:null==t?void 0:t.minMargin,minimumPins:null==t?void 0:t.minimumPins,interpolationRatio:null==t?void 0:t.interpolationRatio},coordinates:t.coordinates.length>0?t.coordinates.map(e=>[e.latitude,e.longitude]):e});a.useEffect(()=>{const e=oe.current,t=!se.current;if(de&&e)switch(U){case"BOUNDS":if(ee){const n=Bt(ee),{sw:a,ne:l}=n;t?null==N||N(n,t):e.fitBounds(a,l,void 0,k).then(()=>null==N?void 0:N(n,t))}break;case"CENTER_AND_ZOOM":if(null!==H&&null!==Y){const n=$t(H,Y),{center:a,zoom:l}=n;t||e.centerAndZoomMap(a,l,k),null==N||N(n,t)}break;case"COMPUTED_BOUNDS":if(te){const{useBoundsComputation:n,options:a,coordinates:l}=Ft(xt,te);e.boundsContaining(l,n,a).then(n=>{const{sw:a,ne:l}=n;t?null==N||N(n,t):e.fitBounds(a,l,void 0,k).then(()=>null==N?void 0:N(n,t))})}break;case"FIT_MARKERS":(null==xt?void 0:xt.length)>0&&(t?null==N||N(xt,t):e.fitLatLongs(xt,void 0,k).then(()=>null==N?void 0:N(xt,t)));break;case"CENTERED_COMPUTED_BOUNDS":if(ne){const{centeredOn:n}=ne,{coordinates:a}=ne,l={centeredOn:{lat:n.latitude,lng:n.longitude}};e.boundsContaining((e=>e.map(e=>[e.latitude,e.longitude]))(a),!1,l).then(n=>{const{sw:a,ne:l}=n;e.fitBounds(a,l,!0,k).then(()=>null==N?void 0:N(n,t))})}break;default:E&&(t||e.centerAndZoomMap(E.center,E.zoom,k),null==N||N(E,t))}},[de,U,H,Y,ee,te,xt,N,k]);const zt=a.useMemo(()=>{switch(U){case"BOUNDS":return ee?Bt(ee):void 0;case"CENTER_AND_ZOOM":return H&&null!==Y?$t(H,Y):void 0;case"COMPUTED_BOUNDS":return te?Ft(xt,te):void 0;case"CENTERED_COMPUTED_BOUNDS":return ne?{options:{centeredOn:[(e=ne).centeredOn.longitude,e.centeredOn.latitude]},coordinates:e.coordinates.map(e=>[e.latitude,e.longitude])}:void 0;case"FIT_MARKERS":return xt;default:return ge?(e=>{const t=new URL(e),n=new URLSearchParams(t.search).get("visible"),a=null==n?void 0:n.split("|").map(e=>e.split(",").map(e=>parseFloat(e)));return(null==a?void 0:a[0])&&a[1]?{sw:a[0],ne:a[1]}:void 0})(ge):E}var e},[E,ge,U,H,Y,ee,te,xt]),Vt=a.useCallback(e=>{const t={zoomIn:"zoom_in",zoomOut:"zoom_out",drag:"pan",zoomInKeyboard:"zoom_in",zoomOutKeyboard:"zoom_out",pitch:"pan",rotate:"pan",touch:"pan",moveKeyboard:"pan",clusterExtent:"zoom_in"}[null==e?void 0:e.originalEvent];void 0!==t&&pt((e=>{var t,n,a,l,i,o;const r=[[null!=(t=e.sw[0])?t:0,null!=(n=e.sw[1])?n:0],[null!=(a=e.ne[0])?a:0,null!=(l=e.ne[1])?l:0]],s=[];return q(null!=(i=r[0])?i:s,null!=(o=r[1])?o:s)})(e.bounds),t,e.zoom),"zoom_in"===t?Ct():"zoom_out"===t?ht():"pan"===t&&_t()},[_t,pt,Ct,ht]),Gt=a.useCallback(e=>{if(e){const{type:t,id:n=null}=e;if(t&&null!==n)switch(t){case"place":vt(n.toString(),"Point",e.qualifiers||[],"destination");break;case"product":case"property":gt(n.toString(),e.qualifiers||[],"product");break;case"cluster":vt(n.toString(),"Point",[],"cluster")}}},[vt,gt]),Ut=a.useCallback(()=>{setTimeout(()=>{if(oe.current){const e=K(oe.current,"tile",L);mt(e)}},200)},[mt]),qt=(e,t,n)=>{const a=e.onMarkerSelected(t,n);if(void 0!==a){const e=(e=>{var t;return Q(e.type)&&!0===(null==(t=e.qualifiers)?void 0:t.includes(s.lL.GOOGLE))})(t);null!==a?(Se(t),e?(Ce(t.additionalContent),ke(void 0),Pe(void 0)):(Ce(void 0),ke("AdditionalPlaceMarkerInfo"===a.__typename?null==a?void 0:a.directionsTo:void 0),Pe("PlaceCardDetails"===a.__typename?a:void 0))):(Se(void 0),Ce(void 0),ke(void 0),Pe(void 0)),Ue(void 0),Gt(t)}},Ht=a.useCallback((e,t)=>{Ve(!1);const n=(e=>{var t;return null==(t=[e].filter(J))?void 0:t[0]})(e);if(n){const{type:e}=n,{productCardsManagement:a,placeCardsManagement:l}=A||{};if(X(e)&&a)return void((e,t,n)=>{var a;const l=e.onMarkerSelected(t,n);void 0!==l&&(Ce(void 0),Se(null!==l?t:void 0),Ue(null!==l?l:void 0),Gt(t),de&&(null==(a=oe.current)||a.dehighlightFeatures()))})(a,n,t);Q(e)&&l&&qt(l,n,t)}},[A,de]),Kt=a.useCallback((e,t="UNSPECIFIED")=>{if(Ve(!1),e){const{type:n}=e,{productCardsManagement:a,placeCardsManagement:l,onCardDismiss:i}=A||{};(X(n)&&void 0!==(null==a?void 0:a.onMarkerSelected(void 0,e))||Q(n)&&void 0!==(null==l?void 0:l.onMarkerSelected(void 0,e)))&&(Ce(void 0),Se(void 0),Ue(void 0),null==i||i(e,t))}},[A]),jt=a.useCallback(e=>{const{feature:t,action:n}=e;switch(n){case"select":A?Ht(t,he):Gt(t);break;case"clearSelection":Kt(he,"MAP_CLICK")}},[Ht,Kt,he]);if(Re!==M){Fe(M);const e=oe.current,t=M&&!0===(null==M?void 0:M.placeHolder);if(t)Kt(he),Ve(t);else if(null==M?void 0:M.idAndType){if(e){const{id:t,type:n}=M.idAndType;e.selectFeature(t,n);const a=null==(V=null==e?void 0:e.listFeatures().filter(e=>e.id===t&&e.type===n))?void 0:V[0];a&&Ht(a,he)}}else null==e||e.clearSelectedFeature(),Kt(he)}const Wt=a.useCallback(e=>{var t,n,a,l,i,o,r;const{feature:s,keyCode:d}=e;if("Space"===d||"Enter"===d){null==(t=oe.current)||t.selectFeature(s.id,s.type),Ht(s,he),et(null==(a=null==(n=document.activeElement)?void 0:n.parentElement)?void 0:a.firstElementChild);const e=null==(o=null==(i=null==(l=document.activeElement)?void 0:l.parentElement)?void 0:i.nextElementSibling)?void 0:o.firstElementChild;nt(e),null==(r=null==A?void 0:A.nextElementToFocusOnLodgingCardClosedChanged)||r.call(A,e),it(!0)}else Kt(he,"KEYBOARD")},[A,Ht,Kt,he]),Zt=a.useCallback(e=>{const t=document.getElementById("floating-lodging-card"),n=document.getElementById("close-map-card"),a=document.getElementsByClassName("uitk-image-link")[0],{activeElement:l}=document;"Tab"===e.key&&(!e.shiftKey&&lt?(null==tt||tt.focus(),null==t||t.focus(),e.preventDefault(),it(!1)):e.shiftKey||l!==n?e.shiftKey&&l===a&&(null==tt||tt.focus(),e.preventDefault()):(null==tt||tt.focus(),e.preventDefault()))},[lt,He,tt]);a.useEffect(()=>(at.current&&window.removeEventListener("keydown",at.current),window.addEventListener("keydown",Zt),at.current=Zt,()=>{window.removeEventListener("keydown",Zt)}),[Zt]);const Xt=a.useCallback(e=>{(null==e?void 0:e.latLng)&&Et(e.latLng),re.current&&re.current.toggleProximityExpansion()},[Et]);a.useEffect(()=>{oe.current&&oe.current.addBoundChangeListener(Vt,Ke)},[Vt]),a.useEffect(()=>{oe.current&&oe.current.addSelectionChangeListener(jt,Ze)},[jt]),a.useEffect(()=>{oe.current&&oe.current.addTilesContentLoadedListener(Ut,je)},[Ut]);const Qt=a.useCallback(({id:e,type:t,content:n})=>{const{id:a,type:l}=he||{};a===e&&l===t&&Ce(n)},[he]),Jt=a.useCallback(e=>{oe.current=e,e.addBoundChangeListener(Vt,Ke),e.addSelectionChangeListener(jt,Ze),e.addTilesContentLoadedListener(Ut,je),e.addMapClickListener(Xt),e.addFeatureContentLoadedListener(Qt,We),e.addKeyPressListener(Wt,Xe),g&&g(e)},[]),Yt=a.useCallback(e=>{if(ue(!0),fe(void 0),e){let t="";switch(Ot){case s.Nw.MAPBOX:t=e.readConfigParam("mapbox,mapboxAddConf,style");break;case s.Nw.GOOGLE:default:t=e.readConfigParam("googleMaps,gmapsAddConfig,mapId")}const n=e.getBounds();if(n){const e=q(n.sw,n.ne);ut(e,t,S),bt.MAP_PRESENTED.log(j({mapId:t,viewMode:S,duaid:null==Tt?void 0:Tt.duaid,appName:null==kt?void 0:kt.name,[dt.name]:dt.bucket})),ot("action",{action:"map-presented",attributes:{"bounding-box":e}})}else bt.MAP_PRESENTED_FAILED.log(j({viewMode:S,duaid:null==Tt?void 0:Tt.duaid,appName:null==kt?void 0:kt.name,errorMessage:"Map presented failed. bbox could not be found in onInitInternal.",[dt.name]:dt.bucket}))}else bt.MAP_PRESENTED_FAILED.log(j({viewMode:S,duaid:null==Tt?void 0:Tt.duaid,appName:null==kt?void 0:kt.name,errorMessage:"Map presented failed. map is falsy during onInitInternal.",[dt.name]:dt.bucket}));f&&f(e)},[f,ut,S,Ot]);a.useEffect(()=>{oe.current&&oe.current.addFeatureContentLoadedListener(Qt,We)},[Qt]),a.useEffect(()=>{oe.current&&oe.current.addKeyPressListener(Wt,Xe)},[Wt]);const en=a.useCallback((e,t)=>{var n;if(he){const{id:t,type:a}=he;0===e.listFeatures(e=>e.id===t&&e.type===a).length&&(Ve(!1),Ce(void 0),Se(void 0),Ue(void 0),null==(n=null==A?void 0:A.onCardDismiss)||n.call(A,he,"FEATURE_MISSING"))}t&&(setTimeout(()=>{const t=K(e,"search",L);mt(t)},200),h&&h(e,t))},[Ht,h,mt]),tn=a.useCallback(()=>{var e;const t=he;Se(void 0),Ue(void 0),Ce(void 0),t&&(null==(e=null==A?void 0:A.onCardDismiss)||e.call(A,t,"CARD_CLOSE_BUTTON"))},[A,he]),nn=a.useCallback(()=>{var e;he&&(null==(e=null==A?void 0:A.onCardClickCallback)||e.call(A,he))},[A,he]),an=a.useCallback(()=>{var e;he&&(null==(e=null==A?void 0:A.onCardClickScrollToViewCallback)||e.call(A,he))},[A,he]),ln=a.useMemo(()=>{var e,t,n;const l={zIndex:Qe,position:"BOTTOM_CENTER",alignSelf:"center"};if(ze&&!0===(null==M?void 0:M.placeHolder)&&(null==M?void 0:M.idAndType)){const{id:e,type:t}=M.idAndType;return a.createElement(be,{overlayElementId:"floating-card-placeholder",grow:1,maxWidth:"180x",...l},a.createElement(Ne,{view:"COMPACT_HORIZONTAL",id:`${t}-${e}`}))}if(he){const{type:i}=he;if("place"===i)return(null==(e=he.qualifiers)?void 0:e.includes(s.lL.GOOGLE))?a.createElement(we,{placeId:`${he.id}`,data:ye||{},onClose:tn,overlayElementId:"floating-place-card",maxWidth:"104x",...l}):a.createElement(Me,{placeId:`${he.id}`,onClose:tn,overlayElementId:"floating-place-card",maxWidth:"180x",directionsTo:Te,data:Ie,...l});if(("property"===i||"product"===i)&&Ge&&(null==A?void 0:A.productCardsManagement))return a.createElement(Le,{data:Ge,LodgingCard:null==(t=A.productCardsManagement.cardDefinition)?void 0:t.LodgingCard,LodgingCardView:null==(n=A.productCardsManagement.cardDefinition)?void 0:n.LodgingCardView,onCardDismiss:tn,onClickCallback:()=>{nn(),yt()},onClickScrollToView:an,overlayElementId:"floating-lodging-card",maxWidth:"180x",...l,showDismissButton:!0})}},[tn,ye,he,nn,an,Ge,Te,M,ze]);a.useEffect(()=>{if(de&&oe.current&&null!==pe){const e=oe.current;e.hidePolygons().then(()=>{if(pe){const{mode:t,duration:n}=pe,a=`proximity-${t}-${n}`;e.showPolygons({id:a,type:"place"}).then(()=>{const[l]=e.listFeatures(e=>e.id===a&&"place"===e.type,void 0,void 0,!1).filter(J);if(l){const{sw:a,ne:i}=e.boundsContainingPolygon(l.polygon);e.fitBounds(a,i,!0,k).then(()=>{null==x||x({modeIndex:t,durationIndex:n,polygon:l.polygon})})}else null==x||x(void 0)})}else null==x||x(void 0)})}},[pe,de,x]);const on=(null==t?void 0:t.tnlFields)&&$e(null==t?void 0:t.tnlFields)?a.createElement(qe,{data:t.tnlFields,onProximityChange:e=>me(e),overlayElementId:"proximity-dialog",zIndex:Qe,position:"BOTTOM_CENTER",alignSelf:"center",ref:re}):null,rn=ge?a.createElement(l.M,{imageFit:"cover"},a.createElement(i.F,{src:ge,alt:"static map",additionalProps:{fetchpriority:"high"}})):null;if(!It&&!de)return a.createElement("div",{style:{height:I}},rn,a.createElement(o.P,{type:"relative",position:{top:"center",left:"center"}},a.createElement(r.Y,{visible:!0})));const sn=!!t&&!!t.customPlace&&a.createElement(Ee,{essAdapterPageId:D,viewportProps:(e=>{switch(e){case"SRP":default:return{sm:"BOTTOM_CENTER",md:"BOTTOM_CENTER"};case"TRIPS":return{sm:"BOTTOM_CENTER",md:"TOP_LEFT"}}})($),customPlaceInfo:t.customPlace,customFeatureUpdated:R,predefinedPlace:B});return a.createElement("div",{style:{height:"100%",position:"relative"}},rn,sn,a.createElement(d.T,{accessToken:Pt,mapType:Ot,initialViewport:zt,beforeInit:Jt,onInit:Yt,height:I,mapConfig:Lt,mapTypeVersion:At,features:Dt,onFeaturesPushed:en,egDistancesEnabled:T,clientPadding:k,"data-dd-action-name":"dynamic-map"},a.createElement(_e,null,ln,on,e)))};et.displayName="sharedui-DynamicMap",et.fragment=pe}}]);
//# sourceMappingURL=https://bernie-assets.s3.us-west-2.amazonaws.com/shopping-pwa/shared-ui-retail-dynamic-map.192e275e07143aed0a47.js.map